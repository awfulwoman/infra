# - name: Ensure domains exist
#   community.digitalocean.digital_ocean_domain:
#     state: present
#     name: "{{ item.domain }}"
#     oauth_token: "{{ vault_digitalocean_full_access_token }}"
#     project_name: "{{ item.project }}"
#   loop: "{{ infra_domains_domains }}"

# - name: Loop over each domains and deal with records
#   ansible.builtin.include_tasks:
#     file: records.yaml
#   loop: "{{ infra_domains_domains }}"
#   loop_control:
#     loop_var: item
#     extended: true

- name: Basic deploy of a service
  community.general.terraform:
    project_path: /opt/infra/terraform/personal-domains
    state: present
