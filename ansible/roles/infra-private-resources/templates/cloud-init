#cloud-config
# Absolute minimal cloud-init - just user and SSH
# Everything else handled by Ansible

disable_root: true

users:
  - name: {{ ansible_user }}
    sudo: "ALL=(ALL) NOPASSWD:ALL"
    groups: users, adm, sudo
    shell: /bin/bash
    ssh_authorized_keys: {{ github_keys_list | to_json }}
    lock_passwd: false

# Ensure SSH is enabled and started
ssh_pwauth: false
runcmd:
  - systemctl enable ssh
  - systemctl start ssh
